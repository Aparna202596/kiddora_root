{% extends "base_profile.html" %}
{% block content %}
<h2>{{ product.product_name }}</h2>
<p>Brand: {{ product.brand }}</p>
<p>Price: <span id="variantPrice">{{ product.final_price }}</span></p>
<p>Stock: <span id="variantStock">Select variant</span></p>

<div>
    <h4>Select Color:</h4>
    {% for variant in variants %}
        <button class="variant-btn" data-variant-id="{{ variant.id }}">{{ variant.color }} / {{ variant.size }}</button>
    {% endfor %}
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(".variant-btn").click(function(){
    let variant_id = $(this).data("variant-id");
    $.get("{% url 'ajax_variant_info' %}", {variant_id: variant_id}, function(data){
        if(data.error){
            alert(data.error);
        } else {
            $("#variantPrice").text(data.price);
            $("#variantStock").text(data.quantity_available > 0 ? data.quantity_available : "Out of stock");
        }
    });
});
</script>
{% endblock %}
