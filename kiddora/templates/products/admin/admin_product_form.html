{% extends "base_admin.html" %}

{% block content %}
<style>
.form-box {
    width: 60%;
    margin: auto;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
}
label {
    display: block;
    margin-top: 10px;
    font-weight: 600;
}
input[type="text"],
input[type="number"],
select,
textarea {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
}
button {
    margin-top: 20px;
    padding: 10px 18px;
    background: #28a745;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}
.variant-box {
    margin-top: 20px;
    border: 1px solid #ddd;
    padding: 15px;
    border-radius: 5px;
    background: #ffffff;
}
.variant-box small {
    color: #666;
}
.custom-multiselect {
    width: 100%;
    padding: 8px;
    cursor: pointer;
}

/* Expand list only when clicked */
.custom-multiselect:focus {
    size: 6;
}

/* Optional: cleaner look */
.custom-multiselect option[disabled] {
    color: #888;
}
.form-actions {
    display: flex;
    gap: 10px;
}
</style>

<div class="form-box">
    <h2>{{ product|default:"Add Product" }}</h2>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- Product Info -->
        <label>Product Name</label>
        <input type="text" name="product_name"
                value="{{ product.product_name|default:'' }}" required>

        <label>Brand</label>
        <input type="text" name="brand"
                value="{{ product.brand|default:'' }}" required>

        <label>Base Price</label>
        <input type="number" step="0.01" name="base_price"
                value="{{ product.base_price|default:'' }}" required>

        <label>Discount %</label>
        <input type="number" name="discount"
                value="{{ product.discount_percent|default:0 }}">

        <label>Final Price</label>
        <input type="number" step="0.01" name="final_price"
                value="{{ product.final_price|default:'' }}" required>

        <label>SKU</label>
        <input type="text" name="sku"
                value="{{ product.sku|default:'' }}" required>

        <!-- Category -->
        <label>Category</label>
        <select name="category" id="category-select" required>
            {% for cat in categories %}
            <option value="{{ cat.id }}"
                {% if product and product.subcategory.category.id == cat.id %}selected{% endif %}>
                {{ cat.category_name }}
            </option>
            {% endfor %}
        </select>

        <!-- SubCategory -->
        <label>SubCategory</label>
        <select name="subcategory" id="subcategory-select" required>
            {% for sub in subcategories %}
            <option value="{{ sub.id }}"
                {% if product and product.subcategory.id == sub.id %}selected{% endif %}>
                {{ sub.subcategory_name }}
            </option>
            {% endfor %}
        </select>

        <!-- Images -->
        <label>Upload Images (Min 3)</label>
        <input type="file" name="images" accept="image/*" multiple required>

        <!-- VARIANTS (UPDATED LOGIC) -->
        <div class="variant-box">
            <h4>Product Variants</h4>

            <!-- COLORS -->
            <label>Product Colors</label>
            <small style="color:#666;"><i>(Enter one color per line)</i></small>
            <textarea name="color" rows="3" placeholder="Red
Blue
Green"></textarea>

            <!-- AGE GROUPS -->
            <label>Age Group</label>
            <select name="age" multiple size="1" class="custom-multiselect" required>
                <option disabled selected>Select Age</option>
                <option value="0-6 months">0–6 months</option>
                <option value="6-12 months">6–12 months</option>
                <option value="1-2 years">1–2 years</option>
                <option value="2-3 years">2–3 years</option>
                <option value="3-5 years">3–5 years</option>
                <option value="5-7 years">5–7 years</option>
                <option value="7-10 years">7–10 years</option>
                <option value="10-15 years">10–15 years</option>
            </select>

            <!-- SIZE -->
            <label>Size</label>
            <select name="size" multiple size="1" class="custom-multiselect" required>
                <option disabled selected>Select Size</option>
                <option value="XS">XS</option>
                <option value="S">S</option>
                <option value="M">M</option>
                <option value="L">L</option>
                <option value="XL">XL</option>
            </select>
        </div>


        <!-- Actions -->
        <div class="form-actions">
            <button type="submit">Save Product</button>
            <a href="{% url 'products:admin_product_list' %}" class="btn btn-secondary"></a>
        </div>
    </form>
</div>

{% endblock %}
