{% load static %}
<link rel="stylesheet" href="{% static 'css/ui-utils.css' %}">
<script src="{% static 'js/ui-utils.js' %}"></script>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Kiddora{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Icons (Font Awesome) -->
    
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
        integrity="sha512-..."
        crossorigin="anonymous"
        referrerpolicy="no-referrer" />
    <style>
/* GLOBAL RESET & BASE */
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:"Segoe UI", Arial, sans-serif; background-color:#fff; color:#333; }
        a { text-decoration:none; color:inherit; }
        ul { list-style:none; }
/* HEADER */
        .site-header {
            width: 100%;
            background: #ffffff;
            border-bottom: 1px solid #eaeaea;
        }
        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 14px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .logo img { height: 42px; }
/* Navigation */
        .main-nav ul { display: flex; gap: 20px; align-items:center; }
        .main-nav ul li a { font-size: 15px; font-weight: 500; color: #333; }
        .main-nav ul li a:hover { color: #ff66cc; }
        .category-dropdown { padding: 5px 10px; border-radius: 5px; border:1px solid #ccc; }
/* Header Actions */
        .header-actions { display:flex; align-items:center; gap:15px; }
        .search-form { position: relative; display:flex; }
        .search-form input {
            width: 180px; height:34px; padding:0 10px; border:1px solid #ccc; border-radius:18px;
        }
        .search-form button {
            border:none; background:#f06292; color:#fff; padding:0 12px; border-radius:18px; cursor:pointer;
        }
        .search-form button:hover { background:#e91e63; }
        .icon-btn { font-size:18px; color:#333; text-decoration:none; }
        .icon-btn:hover { color:#ff66cc; }
        .icon-btn.profile { border:1px solid #ddd; padding:7px; border-radius:50%; }
        /* ACCOUNT LAYOUT */
.account-layout {
    max-width: 1400px;
    margin: auto;
    display: flex;
    gap: 30px;
}

/* ========== FILTER SIDEBAR ========== */
.filter {
    width: 260px;
    background: #fff;
    border-radius: 10px;
    padding: 18px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.06);
}

.filter-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 18px;
}

.filter-header h3 {
    font-size: 15px;
    font-weight: 600;
    display: flex;
    gap: 8px;
    align-items: center;
}

.clear-btn {
    font-size: 12px;
    color: #f06292;
}

.sidebar-menu {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.sidebar-menu details {
    border-bottom: 1px solid #eee;
    padding-bottom: 10px;
}

.sidebar-menu summary {
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 10px;
}

.sidebar-menu summary::-webkit-details-marker {
    display: none;
}

.filter-options {
    margin-top: 10px;
    padding-left: 6px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    font-size: 13px;
}

.filter-options label {
    display: flex;
    gap: 8px;
    cursor: pointer;
}

.hierarchy {
    margin-left: 12px;
    margin-top: 6px;
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.apply-filter-btn {
    margin-top: 18px;
    width: 100%;
    padding: 9px;
    border: none;
    background: #f06292;
    color: #fff;
    border-radius: 6px;
    font-size: 14px;
}
.apply-filter-btn:hover {
    background: #e91e63;
}

/* CONTENT AREA */
.account-content {
    flex: 1;
    background: #fff;
    border-radius: 10px;
    padding: 30px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.06);
}

/* RESPONSIVE */
@media (max-width: 992px) {
    .account-layout {
        flex-direction: column;
    }

    .account-sidebar {
        width: 100%;
    }
}
{% comment %} /* MAIN CONTENT*/
        .main-content { min-height:60vh; padding:40px 20px; } {% endcomment %}
/* FOOTER */
        .site-footer { background:#fff; padding-top:40px; border-top:1px solid #fff; }
        .footer-container {
            max-width:1200px; margin:auto; padding:0 20px;
            display:grid; grid-template-columns:repeat(4,1fr); gap:30px;
        }
        .footer-logo img { height:50px; }
        .footer-column h4 { font-size:15px; margin-bottom:15px; color:#000; }
        .footer-column ul li { margin-bottom:8px; }
        .footer-column ul li a { font-size:14px; color:#555; }
        .footer-column ul li a:hover { color:#f06292; }
        .footer-column form { display:flex; flex-direction:column; gap:10px; }
        .footer-column input[type="email"] { padding:8px 10px; border:1px solid #fff; border-radius:5px; }
        .footer-column button { padding:8px; border:none; background:#f06292; color:#fff; border-radius:5px; cursor:pointer; }
        .footer-column button:hover { background:#e91e63; }
        .social-icons { margin-top:15px; display:flex; gap:15px; }
        .social-icons a { font-size:18px; color:#333; }
        .social-icons a:hover { color:#f06292; }
        .footer-bottom { text-align:center; padding:15px 0; margin-top:30px; font-size:13px; color:#393939; border-top:1px solid #fff; }
/* RESPONSIVE */
        @media (max-width:992px) { .main-nav { display:none; } .footer-container { grid-template-columns:repeat(2,1fr); } }
        @media (max-width:576px) { .footer-container { grid-template-columns:1fr; } .search-form input { width:140px; } }
    </style>
</head>
<body>
<!-- HEADER -->
    <header class="site-header">
        <div class="header-container">
<!-- Logo -->
            <div class="logo">
                <a href="{% url 'store:home' %}">
                    <img src="{% static 'images/kiddora_logo.PNG' %}" alt="Kiddora Logo">
                </a>
            </div>
<!-- Navigation -->
            <nav class="main-nav">
                <ul>
                    <li><a href="{% url 'store:home' %}">Home</a></li>
                    <li><a href="{% url 'store:about_us' %}">About Us</a></li>
                    <li><a href="{% url 'products:category_list' %}">Category</a></li>
                    <li><a href="{% url 'products:product_list'%}">Shop</a></li>
                    <li><a href="{% url 'store:contact_us' %}">Contact</a></li>
                </ul>
            </nav>
<!-- Actions -->
            <div class="header-actions">
<!-- Search -->
                <form method="get" action="{% url 'products:product_search' %}" class="search-form">
                    <input 
                        type="text"
                        name="q"
                        placeholder="Search products..."
                        value="{{ request.GET.q|default:'' }}"
                        required>
                    <button type="submit" aria-label="Search">
                        <i class="fa fa-search"></i>
                    </button>
                </form>
<!-- Wishlist -->
                <a href="#" class="icon-btn"><i class="fa-regular fa-heart"></i></a>
<!-- Profile -->
                <a href="{% url 'accounts:user_profile' %}" class="icon-btn profile"><i class="fa-regular fa-user"></i></a>
<!-- Cart -->
                <a href="#" class="icon-btn"><i class="fa fa-shopping-cart"></i></a>
            </div>
        </div>
    </header>

    <main class="main-content">
    <div class="account-layout">

<!-- SIDEBAR -->
<aside class="filter">

    <!-- HEADER -->
    <div class="filter-header">
        <h3><i class="fa-solid fa-sliders"></i> FILTER & SORT</h3>
        <a href="{{ request.path }}" class="clear-btn">Clear All</a>
    </div>

    <form method="get">
        <ul class="sidebar-menu">
            <!-- SORT BY -->
            <li>
                <details>
                    <summary><i class="fa-solid fa-arrow-up-wide-short"></i> Sort By</summary>
                    <div class="filter-options">
                        {% for option in sort_options %}
                            <label>
                                <input type="checkbox" name="sort_by" value="{{ option.key }}">
                                {{ option.label }}
                            </label>
                        {% endfor %}
                    </div>
                </details>
            </li>


            <!-- AGE GROUP -->
            <li>
                <details>
                    <summary><i class="fa-solid fa-child"></i> Age Group</summary>
                    <div class="filter-options">
                        {% for age in age_groups %}
                            <label>
                                <input type="checkbox" name="age" value="{{ age.id }}">
                                {{ age.name }}
                            </label>
                        {% empty %}
                            <span class="empty">No age groups</span>
                        {% endfor %}
                    </div>
                </details>
            </li>

            <!-- FABRIC TYPE -->
            <li>
                <details>
                    <summary>
                        <i class="fa-solid fa-shirt"></i> Fabric Type
                    </summary>

                    <div class="filter-options">
                        {% for fabric in fabric_types %}
                            <label>
                                <input type="checkbox" name="fabric" value="{{ fabric }}">
                                {{ fabric|title }}
                            </label>
                        {% empty %}
                            <span style="font-size:12px;color:#999;">
                                No fabric types available
                            </span>
                        {% endfor %}
                    </div>
                </details>
            </li>

            <!-- PRODUCT TYPES (DYNAMIC HIERARCHY) -->
            <li>
                <details>
                    <summary>
                        <i class="fa-solid fa-layer-group"></i> Product Types
                    </summary>

                    <div class="filter-options">

                        {% for category in categories %}
                            <!-- CATEGORY -->
                            <label>
                                <input type="checkbox" name="category" value="{{ category.id }}">
                                {{ category.category_name }}
                            </label>

                            <div class="hierarchy">
                                {% for sub in category.subcategories.all %}
                                    <!-- SUBCATEGORY -->
                                    <label>
                                        <input type="checkbox" name="subcategory" value="{{ sub.id }}">
                                        {{ sub.subcategory_name }}
                                    </label>

                                    <div class="hierarchy">
                                        {% for product in sub.products.all %}
                                            <!-- PRODUCT -->
                                            <label>
                                                <input type="checkbox" name="product" value="{{ product.id }}">
                                                {{ product.product_name }}
                                            </label>

                                            <div class="hierarchy">
                                                {% for variant in product.variants.all %}
                                                    <!-- PRODUCT VARIANT -->
                                                    <label>
                                                        <input type="checkbox" name="variant" value="{{ variant.id }}">
                                                        {{ variant.color }} / {{ variant.size }}
                                                    </label>
                                                {% endfor %}
                                            </div>
                                        {% endfor %}
                                    </div>
                                {% endfor %}
                            </div>

                        {% endfor %}

                    </div>
                </details>
            </li>

            <!-- GENDER -->
            <li>
                <details>
                    <summary><i class="fa-solid fa-children"></i> Gender</summary>
                    <div class="filter-options">
                        {% for gender in genders %}
                            <label>
                                <input type="checkbox" name="gender" value="{{ gender.code }}">
                                {{ gender.label }}
                            </label>
                        {% endfor %}
                    </div>
                </details>
            </li>

            <!-- COLOR -->
            <li>
                <details>
                    <summary>
                        <i class="fa-solid fa-palette"></i> Color
                    </summary>

                    <div class="filter-options">
                        {% for color in colors %}
                            <label>
                                <input type="checkbox" name="color" value="{{ color }}">
                                {{ color|title }}
                            </label>
                        {% empty %}
                            <span style="font-size:12px;color:#999;">No colors available</span>
                        {% endfor %}
                    </div>
                </details>
            </li>

            <!-- PRICE -->
            <li>
                <details>
                    <summary><i class="fa-solid fa-indian-rupee-sign"></i> Price</summary>
                    <div class="filter-options">
                        <input type="number"
                                name="min_price"
                                placeholder="Min"
                                value="{{ request.GET.min_price|default:min_price }}">

                        <input type="number"
                                name="max_price"
                                placeholder="Max"
                                value="{{ request.GET.max_price|default:max_price }}">
                    </div>
                </details>
            </li>


        </ul>

        <button type="submit" class="apply-filter-btn">
            Apply Filters
        </button>

    </form>
</aside>


<!-- PAGE CONTENT -->
        <section class="account-content">
            {% block content %}{% endblock %}
        </section>

    </div>
</main>

<!-- FOOTER -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-logo"><img src="{% static 'images/kiddora_logo.PNG' %}" alt="Kiddora Logo"></div>
            <div class="footer-column">
                <h4>Info</h4>
                <ul>
                    <li><a href="{% url 'store:contact_us' %}">Contact Us</a></li>
                    <li><a href="{% url 'store:about_us' %}">About Us</a></li>
                    <li><a href="{% url 'store:blog' %}">Blog</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Policies</h4>
                <ul>
                    <li><a href="{% url 'store:privacy_policy' %}">Privacy Notice</a></li>
                    <li><a href="{% url 'store:return_policy' %}">Return Policy</a></li>
                    <li><a href="{% url 'store:terms_conditions' %}">Terms and Conditions</a></li>
                    <li><a href="{% url 'store:cookie_policy' %}">Cookie Policy</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Subscribe to Our Newsletter</h4>
                <form method="post" action="#">
                    {% csrf_token %}
                    <input type="email" name="email" placeholder="Email Address" required>
                    {% comment %} <button type="submit">Subscribe</button> {% endcomment %}
                </form>
                <div class="social-icons">
                    <a href="#" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
                    <a href="#" aria-label="Facebook"><i class="fa-brands fa-facebook"></i></a>
                    <a href="#" aria-label="X"><i class="fa-brands fa-x-twitter"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">Â© 2025 | Kiddora | All Rights Reserved</div>
    </footer>
    {% include "confirm_modal.html" %}
</body>
</html>