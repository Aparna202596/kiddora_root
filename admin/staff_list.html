{% extends "base.html" %}
{% load static %}

{% block content %}
<h2>Staff Management</h2>

<form method="get">
    <input
        type="text"
        name="q"
        placeholder="Search staff by username"
        value="{{ query }}"
    />
    <button type="submit">Search</button>
</form>

<br>

<a href="{% url 'admin_add' %}">
    <button>Add Staff</button>
</a>

<br><br>

<table border="1" cellpadding="10" cellspacing="0">
    <thead>
        <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Email</th>
            <th>Active</th>
            <th>Last Login</th>
            <th>Joined</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% if users %}
            {% for staff in users %}
                <tr>
                    <td>{{ staff.id }}</td>
                    <td>{{ staff.username }}</td>
                    <td>{{ staff.email }}</td>
                    <td>
                        {% if staff.is_active %}
                            Yes
                        {% else %}
                            No
                        {% endif %}
                    </td>
                    <td>
                        {{ staff.last_login|default:"Never" }}
                    </td>
                    <td>
                        {{ staff.date_joined|date:"Y-m-d H:i" }}
                    </td>
                    <td>
                        <a href="{% url 'admin_edit' staff.id %}">Edit</a>

                        <form
                            method="post"
                            action="{% url 'admin_delete' staff.id %}"
                            style="display:inline;"
                        >
                            {% csrf_token %}
                            <button
                                type="submit"
                                onclick="return confirm('Delete this staff user?');"
                            >
                                Delete
                            </button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="7">No staff users found.</td>
            </tr>
        {% endif %}
    </tbody>
</table>

{% endblock %}
